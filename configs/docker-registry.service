[Unit]
Description=Docker Registry
After=network.target docker.service
Requires=docker.service

[Service]
Type=simple
ExecStartPre=-/usr/bin/docker stop registry
ExecStartPre=-/usr/bin/docker rm registry
ExecStart=/usr/bin/docker run --rm --name registry \
  -p 5000:5000 \
  -v /opt/registry/data:/var/lib/registry \
  -e REGISTRY_STORAGE_DELETE_ENABLED=true \
  registry:2.8
ExecStop=/usr/bin/docker stop registry
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
